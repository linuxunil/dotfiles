# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Repository Overview

Ansible-based system configuration management for Linux environments with automated dotfiles deployment. Uses mise for task management and tool installation with role-based Ansible architecture.

## Key Commands

### Essential Setup
```bash
mise install             # Install required tools (Ansible, pipx)
mise run run             # Run the main playbook on all hosts
mise run check           # Dry-run the playbook with diff output
```

### Direct Ansible Commands
```bash
ansible-playbook playbooks/site.yml              # Run main playbook
ansible-playbook playbooks/site.yml --check --diff  # Preview changes
ansible-playbook playbooks/site.yml --limit athena  # Target specific host
```

## Architecture

### Role Structure
- **system**: Linux desktop environment with Hyprland, development tools, and applications
- **dotfiles**: Automated dotfiles management and symlink creation
- **languages**: Language runtime management (currently basic setup)

### Directory Layout
```
├── mise.toml            # Mise task runner and tool management
├── ansible.cfg          # Ansible configuration
├── playbooks/
│   └── site.yml         # Main playbook for Linux workstation setup
├── inventory/
│   └── hosts.yml        # Host definitions (athena.local)
├── group_vars/
│   └── all.yml          # Global Ansible variables
├── roles/               # Ansible roles
│   ├── system/          # Package installation and system setup
│   ├── dotfiles/        # Dotfiles symlink management
│   └── languages/       # Language runtime setup
└── config/              # Static dotfiles (git-managed)
    ├── nvim/            # Neovim configuration
    ├── zellij/          # Terminal multiplexer layouts
    ├── ghostty/         # Terminal emulator config
    └── ...              # Application configurations
```

## Development Guidelines

### Adding Packages
1. Edit `roles/system/defaults/main.yml` for package lists
2. Add DNF packages to `dnf_packages` list
3. Add Flatpak packages to `flatpak_packages` list
4. Add COPR repositories to `copr_repos` if needed
5. Test with `mise run check` before applying

### Managing Dotfiles
- **Edit directly** in `config/` directory - all files are static and git-managed
- **Automated linking** - dotfiles role handles symlink creation
- **Never generate configs** - Ansible only manages symlinks, not content

### Testing Changes
```bash
mise install             # Ensure tools are installed
mise run check           # Validate syntax and preview changes
mise run run             # Apply changes to target hosts
```

## Platform Notes

- **Linux**: Fedora-based with DNF package manager and Flatpak
- **Desktop**: Hyprland compositor with Waybar, Mako, and Wofi
- **Terminal**: Ghostty and Zellij for terminal multiplexing
- **Development**: Neovim, ripgrep, fzf, gh CLI
- **Audio**: Pipewire with PulseAudio compatibility

## Key Features

### Automated Dotfiles Management
- Static configuration files stored in `config/` directory
- Ansible role automatically creates symlinks to home directory
- No dynamic generation - all configs are version controlled

### Zellij Terminal Layouts
Pre-configured layouts in `config/zellij/layouts/` for development workflows

### Remote Deployment
- SSH-based deployment to athena.local Linux workstation
- Inventory-based host configuration
- Idempotent playbook execution

## Important Notes

- Target host: athena.local (Linux workstation)
- All config files are static (git-managed), never generated by Ansible
- Use `mise run check` to preview changes before applying
- COPR repositories used for packages not in main Fedora repos